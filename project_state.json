{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 21,
  "summary": "Mobile-first Scratch & Win reward website for 'Vitalist Water' brand campaign. Users scan a QR code on a bottle and get a random reward via an interactive scratch card UI. After fully scratching, a new unique code and reward amount are revealed. The claim form is hidden by default and only appears after the scratch is complete. Reward distribution is weighted: 90% chance ₹10, 4% chance ₹20, ~3.9% chance ₹30, 2% chance ₹90, 0.1% chance ₹100. After scratching, users click 'Claim' and fill a form (state, city, feedback, UPI ID) to receive payment. A 'Money will be in your account soon' confirmation animation is shown after form submission. Admin panel is accessible by double-clicking the Vitalis logo, then logging in with email 'shajan@vitalis.com' and password 'India@123'. Admin panel shows all submitted coupon codes and claim details, allows coupon verification, and lets admins mark coupons as 'redeemed/closed'. Built with pure HTML/CSS/JS, no backend, embeddable in Google Sites. Premium professional design with uploaded brand logo.",
  "architectural_notes": [
    "Pure HTML/CSS/JS only — no backend, no external paid libraries",
    "Must be embeddable in Google Sites and optimized for QR scan mobile traffic",
    "Reward probability is weighted: 90% ₹10, 4% ₹20, ~3.9% ₹30, 2% ₹90, 0.1% ₹100",
    "Claim form collects state, city, feedback, UPI ID — stored in localStorage for admin panel (no backend)",
    "Admin panel access: double-click Vitalis logo → email/password login (shajan@vitalis.com / India@123)",
    "Claim form is hidden by default; only shown after scratch card is fully revealed",
    "Admin panel must support coupon redemption status: each coupon can be marked as 'redeemed/closed' by the admin; redeemed coupons cannot be claimed again"
  ],
  "known_issues": [
    "Previous UI was reported as very ugly — bottle illustration removed, form visibility and overall layout needs redesign",
    "Claim and Submit buttons are not functioning — clicks do nothing or fail silently",
    "Vitalis logo is not fully visible in the header — appears cropped or poorly styled",
    "Admin panel UI is reported as very bad — needs full redesign and coupon verification/redemption feature",
    "Submit button throws an error after clicking — claim submission flow is broken and needs to be fixed",
    "Claim form submissions are not appearing in the admin panel after submission — data flow between ClaimForm and admin panel data store is broken",
    "Admin panel login is broken — login flow needs to be fixed",
    "Canister xkmoi-tqaaa-aaaab-aaodq-cai is stopped (IC0508) — submitClaim calls are failing with a rejection error; canister needs to be started/restarted before backend calls can succeed",
    "Admin panel throws 'Unauthorized: Only admins can view submissions' error — authorization check is incorrectly blocking admin access to getSubmissions",
    "After claim submission, coupon code, reward amount, UPI ID and other details are not showing in the admin panel — submitted data is not being persisted or retrieved correctly"
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-generate-a-random-reward-amount-between-10-and-100-in-multiples-of-10-every-time-the-page-loads-also-generate-a-unique-alphanumeric-code-e-g-vw-xxxx-xxxx-per-session-that-is-displayed-on-the-scratch-card-before-and-after-reveal",
      "title": "Generate a random reward amount between ₹10 and ₹100 (in multiples of ₹10) every time the page loads. Also generate a unique alphanumeric code (e.g., 'VW-XXXX-XXXX') per session that is displayed on the scratch card before and after reveal.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-scratch-card-ui-component-at-the-center-of-the-page-the-card-uses-a-glassmorphism-style-frosted-glass-effect-soft-shadows-semi-transparent-layers-with-a-silver-grey-scratch-overlay-the-user-scratches-the-overlay-by-dragging-a-finger-or-mouse-to-reveal-the-reward-amount-beneath-the-unique-code-is-printed-on-the-front-face-of-the-card-visible-before-scratching",
      "title": "Implement a scratch card UI component at the center of the page. The card uses a glassmorphism style (frosted glass effect, soft shadows, semi-transparent layers) with a silver/grey scratch overlay. The user scratches the overlay by dragging a finger or mouse to reveal the reward amount beneath. The unique code is printed on the front face of the card (visible before scratching).",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-trigger-a-confetti-burst-celebration-animation-immediately-after-the-scratch-card-reward-is-fully-revealed-use-a-lightweight-canvas-based-confetti-implementation-no-external-paid-libraries-confetti-should-use-blue-white-and-gold-colors-matching-the-vitalist-water-brand",
      "title": "Trigger a confetti burst celebration animation immediately after the scratch card reward is fully revealed. Use a lightweight canvas-based confetti implementation (no external paid libraries). Confetti should use blue, white, and gold colors matching the Vitalist Water brand.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-play-a-light-scratch-sound-effect-when-the-user-begins-scratching-the-card-and-a-winning-chime-bell-sound-when-the-reward-is-revealed-sounds-must-be-generated-programmatically-using-the-web-audio-api-no-external-audio-files-or-paid-libraries",
      "title": "Play a light scratch sound effect when the user begins scratching the card, and a winning chime/bell sound when the reward is revealed. Sounds must be generated programmatically using the Web Audio API (no external audio files or paid libraries).",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-animate-water-drop-particles-falling-on-page-load-for-approximately-2-seconds-before-settling-giving-a-refreshing-water-brand-feel-after-the-drops-settle-the-main-ui-appears-with-a-smooth-fade-in",
      "title": "Animate water drop particles falling on page load for approximately 2 seconds before settling, giving a refreshing water brand feel. After the drops settle, the main UI appears with a smooth fade-in.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-structure-the-page-into-the-following-sections-in-order-1-logo-section-at-the-top-with-the-vitalist-water-brand-name-and-a-water-drop-icon-2-hero-area-with-the-tagline-scan-scratch-win-and-a-stylized-water-bottle-illustration-or-image-3-congratulations-heading-above-the-scratch-card-4-scratch-card-component-in-the-center-5-reward-reveal-section-showing-the-large-bold-amount-after-scratching-6-footer-with-the-vitalist-water-brand-name-and-a-small-copyright-line",
      "title": "Structure the page into the following sections in order: (1) Logo section at the top with the 'Vitalist Water' brand name and a water-drop icon, (2) Hero area with the tagline 'Scan. Scratch. Win.' and a stylized water bottle illustration or image, (3) Congratulations heading above the scratch card, (4) Scratch card component in the center, (5) Reward reveal section showing the large bold ₹ amount after scratching, (6) Footer with the 'Vitalist Water' brand name and a small copyright line.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-premium-vitalist-water-visual-theme-blue-to-white-gradient-background-glassmorphism-card-panels-modern-sans-serif-typography-centered-single-column-layout-optimized-for-mobile-screens-max-width-420px-all-interactive-elements-must-have-smooth-css-transitions-and-hover-active-states-the-overall-feel-should-convey-purity-freshness-and-premium-quality",
      "title": "Apply a premium Vitalist Water visual theme: blue-to-white gradient background, glassmorphism card panels, modern sans-serif typography, centered single-column layout optimized for mobile screens (max-width ~420px). All interactive elements must have smooth CSS transitions and hover/active states. The overall feel should convey purity, freshness, and premium quality.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-all-existing-logo-header-references-with-the-uploaded-vitalist-water-brand-logo-vitalis-logo-png-use-it-in-the-header-logo-component-at-full-quality-with-appropriate-sizing-remove-text-only-fallbacks-where-the-image-is-available-ensure-the-logo-is-crisp-and-prominent-at-the-top-of-the-page",
      "title": "Replace all existing logo/header references with the uploaded Vitalist Water brand logo (vitalis-logo.png). Use it in the header/Logo component at full quality with appropriate sizing. Remove text-only fallbacks where the image is available. Ensure the logo is crisp and prominent at the top of the page.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-overhaul-the-entire-visual-design-to-a-premium-professional-level-apply-a-deep-ocean-to-light-blue-gradient-background-elevated-glassmorphism-card-panels-with-stronger-blur-and-refined-borders-high-contrast-modern-typography-using-a-clean-sans-serif-font-refined-spacing-and-padding-polished-button-styles-with-gradient-fills-and-subtle-glow-effects-and-micro-animations-on-interactive-elements-the-overall-aesthetic-must-feel-like-a-premium-brand-campaign-similar-to-high-end-fmcg-product-promotions",
      "title": "Overhaul the entire visual design to a premium professional level. Apply a deep ocean-to-light-blue gradient background, elevated glassmorphism card panels with stronger blur and refined borders, high-contrast modern typography using a clean sans-serif font, refined spacing and padding, polished button styles with gradient fills and subtle glow effects, and micro-animations on interactive elements. The overall aesthetic must feel like a premium brand campaign — similar to high-end FMCG product promotions.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-weighted-reward-probability-in-rewardgenerator-ts-to-90-chance-of-10-4-chance-of-20-3-9-chance-of-30-2-chance-of-90-and-0-1-chance-of-100-remove-any-other-reward-amounts",
      "title": "Update the weighted reward probability in rewardGenerator.ts to: 90% chance of ₹10, 4% chance of ₹20, 3.9% chance of ₹30, 2% chance of ₹90, and 0.1% chance of ₹100. Remove any other reward amounts.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-after-the-scratch-card-reward-is-revealed-display-a-prominent-click-to-claim-your-reward-button-below-the-reward-amount-tapping-clicking-this-button-scrolls-to-or-reveals-a-claim-form-the-form-must-contain-a-state-dropdown-or-text-input-a-city-text-input-a-feedback-textarea-and-a-upi-id-text-input-all-fields-are-required-the-form-must-be-styled-consistently-with-the-premium-glassmorphism-design-theme",
      "title": "After the scratch card reward is revealed, display a prominent 'Click to Claim Your Reward' button below the reward amount. Tapping/clicking this button scrolls to or reveals a claim form. The form must contain: a 'State' dropdown or text input, a 'City' text input, a 'Feedback' textarea, and a 'UPI ID' text input. All fields are required. The form must be styled consistently with the premium glassmorphism design theme.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-after-the-user-submits-the-claim-form-successfully-hide-the-form-and-display-a-full-screen-or-overlay-animated-confirmation-notification-the-notification-must-show-the-message-money-will-be-in-your-account-soon-with-a-celebration-animation-e-g-animated-checkmark-ripple-pulse-effect-or-animated-coins-wallet-icon-animate-the-notification-s-entrance-with-a-smooth-scale-up-or-slide-up-transition-use-brand-colors-blue-white-gold",
      "title": "After the user submits the claim form successfully, hide the form and display a full-screen or overlay animated confirmation notification. The notification must show the message 'Money will be in your account soon!' with a celebration animation (e.g., animated checkmark, ripple/pulse effect, or animated coins/wallet icon). Animate the notification's entrance with a smooth scale-up or slide-up transition. Use brand colors (blue, white, gold).",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-separate-admin-panel-page-or-route-accessible-via-a-hidden-discrete-link-e-g-admin-or-a-small-footer-link-the-admin-panel-must-display-a-table-list-of-all-submitted-claim-entries-coupon-code-reward-amount-state-city-upi-id-feedback-timestamp-allow-searching-filtering-by-coupon-code-show-the-total-number-of-submissions-and-a-breakdown-of-reward-amounts-distributed-protect-the-admin-panel-with-a-simple-hardcoded-password-prompt-e-g-vitalis2024-style-it-cleanly-with-the-brand-theme",
      "title": "Create a separate Admin Panel page or route accessible via a hidden/discrete link (e.g., '/admin' or a small footer link). The admin panel must: display a table/list of all submitted claim entries (coupon code, reward amount, state, city, UPI ID, feedback, timestamp); allow searching/filtering by coupon code; show the total number of submissions and a breakdown of reward amounts distributed. Protect the admin panel with a simple hardcoded password prompt (e.g., 'vitalis2024'). Style it cleanly with the brand theme.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-change-the-admin-panel-access-mechanism-instead-of-the-current-simple-password-prompt-or-footer-link-the-admin-panel-must-be-triggered-by-double-clicking-the-vitalis-logo-in-the-header-after-the-double-click-display-a-modal-login-dialog-that-prompts-for-an-email-field-and-a-password-field-the-hardcoded-valid-credentials-must-be-email-shajan-vitalis-com-and-password-india-123-if-credentials-match-navigate-to-or-reveal-the-admin-panel-if-they-do-not-match-show-an-inline-error-message-the-logo-double-click-trigger-must-be-invisible-to-regular-users-no-visible-hint-or-label",
      "title": "Change the admin panel access mechanism: instead of the current simple password prompt or footer link, the admin panel must be triggered by double-clicking the Vitalis logo in the header. After the double-click, display a modal login dialog that prompts for an email field and a password field. The hardcoded valid credentials must be email: 'shajan@vitalis.com' and password: 'India@123'. If credentials match, navigate to or reveal the admin panel. If they do not match, show an inline error message. The logo double-click trigger must be invisible to regular users (no visible hint or label).",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-remove-the-water-bottle-illustration-and-the-hero-section-entirely-from-scratchpage-the-page-layout-should-be-logo-at-top-scan-scratch-win-tagline-as-a-simple-text-line-no-hero-image-congratulations-you-have-won-heading-scratch-card-reward-reveal-shown-only-after-scratch-claim-form-shown-only-after-scratch-footer",
      "title": "Remove the water bottle illustration and the Hero section entirely from ScratchPage. The page layout should be: Logo at top → 'Scan. Scratch. Win.' tagline (as a simple text line, no hero image) → 'Congratulations! You have won' heading → Scratch card → Reward reveal (shown only after scratch) → Claim form (shown only after scratch) → Footer.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-after-the-scratch-card-is-fully-scratched-100-revealed-automatically-generate-a-brand-new-unique-vw-xxxx-xxxx-code-and-a-new-weighted-random-reward-amount-display-the-new-code-and-new-amount-on-the-revealed-scratch-card-face-immediately-after-the-scratch-completes",
      "title": "After the scratch card is fully scratched (100% revealed), automatically generate a brand-new unique VW-XXXX-XXXX code and a new weighted random reward amount. Display the new code and new amount on the revealed scratch card face immediately after the scratch completes.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-the-claim-form-claimform-component-and-the-reward-reveal-section-rewardreveal-component-must-be-completely-hidden-and-not-rendered-in-the-dom-until-the-scratch-card-has-been-fully-scratched-after-the-scratch-completes-reveal-both-sections-with-a-smooth-fade-in-slide-up-css-transition-no-claim-button-or-form-fields-should-be-visible-to-the-user-before-scratching-is-complete",
      "title": "The claim form (ClaimForm component) and the reward reveal section (RewardReveal component) must be completely hidden and not rendered in the DOM until the scratch card has been fully scratched. After the scratch completes, reveal both sections with a smooth fade-in / slide-up CSS transition. No claim button or form fields should be visible to the user before scratching is complete.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-perform-a-comprehensive-ui-redesign-of-the-scratchpage-to-fix-the-ugly-layout-apply-a-clean-spacious-single-column-mobile-first-layout-max-width-420px-centered-use-the-existing-deep-ocean-to-light-blue-gradient-background-the-scratch-card-must-be-the-dominant-visual-element-large-centered-with-strong-glassmorphism-backdrop-blur-semi-transparent-white-border-subtle-shadow-reward-reveal-and-claim-form-sections-must-each-be-contained-in-well-padded-glassmorphism-cards-with-clear-typographic-hierarchy-remove-any-cramped-overlapping-or-misaligned-elements-ensure-all-sections-have-consistent-vertical-spacing-and-the-overall-page-looks-polished-and-premium",
      "title": "Perform a comprehensive UI redesign of the ScratchPage to fix the ugly layout. Apply a clean, spacious single-column mobile-first layout (max-width 420px, centered). Use the existing deep ocean-to-light-blue gradient background. The scratch card must be the dominant visual element — large, centered, with strong glassmorphism (backdrop-blur, semi-transparent white border, subtle shadow). Reward reveal and claim form sections must each be contained in well-padded glassmorphism cards with clear typographic hierarchy. Remove any cramped, overlapping, or misaligned elements. Ensure all sections have consistent vertical spacing and the overall page looks polished and premium.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-end-to-end-claim-flow-in-claimform-tsx-ensure-the-submit-button-correctly-triggers-form-validation-calls-the-usesubmitclaim-hook-with-all-required-fields-coupon-code-reward-amount-state-city-feedback-upi-id-handles-loading-and-error-states-visibly-and-on-success-shows-the-confirmationnotification-component-trace-and-fix-any-broken-prop-wiring-or-missing-state-connections-between-scratchpage-rewardreveal-and-claimform-that-prevent-clicks-from-having-any-effect",
      "title": "Fix the end-to-end claim flow in ClaimForm.tsx: ensure the 'Submit' button correctly triggers form validation, calls the useSubmitClaim hook with all required fields (coupon code, reward amount, state, city, feedback, UPI ID), handles loading and error states visibly, and on success shows the ConfirmationNotification component. Trace and fix any broken prop wiring or missing state connections between ScratchPage, RewardReveal, and ClaimForm that prevent clicks from having any effect.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-vitalis-logo-display-in-the-logo-component-and-header-area-ensure-vitalis-logo-png-renders-at-full-size-without-any-cropping-clipping-or-overflow-hidden-that-cuts-it-off-set-explicit-dimensions-appropriate-for-a-mobile-header-e-g-height-64-80px-auto-width-use-object-fit-contain-remove-any-conflicting-max-width-or-overflow-constraints-and-ensure-the-logo-is-fully-visible-and-prominent-on-all-screen-sizes",
      "title": "Fix the Vitalis logo display in the Logo component and header area: ensure vitalis-logo.png renders at full size without any cropping, clipping, or overflow hidden that cuts it off. Set explicit dimensions appropriate for a mobile header (e.g., height 64–80px, auto width), use object-fit: contain, remove any conflicting max-width or overflow constraints, and ensure the logo is fully visible and prominent on all screen sizes.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-fully-redesign-the-adminpanel-page-frontend-src-pages-adminpanel-tsx-with-a-professional-polished-ui-apply-the-brand-glassmorphism-design-system-backdrop-blur-panels-gradient-background-clean-typography-layout-must-include-1-a-stats-summary-row-at-the-top-showing-total-submissions-and-reward-breakdowns-2-a-prominent-coupon-verification-tool-a-text-input-where-the-admin-can-enter-a-vw-xxxx-xxxx-code-and-click-verify-to-see-full-submission-details-and-the-current-status-of-that-coupon-active-or-redeemed-closed-3-a-full-searchable-filterable-submissions-table-with-columns-coupon-code-reward-amount-state-city-upi-id-feedback-timestamp-and-status-the-table-must-have-clear-row-styling-alternating-or-bordered-rows-and-be-horizontally-scrollable-on-mobile",
      "title": "Fully redesign the AdminPanel page (frontend/src/pages/AdminPanel.tsx) with a professional, polished UI. Apply the brand glassmorphism design system (backdrop-blur panels, gradient background, clean typography). Layout must include: (1) a stats summary row at the top showing total submissions and reward breakdowns; (2) a prominent coupon verification tool — a text input where the admin can enter a VW-XXXX-XXXX code and click 'Verify' to see full submission details and the current status of that coupon (active or redeemed/closed); (3) a full searchable/filterable submissions table with columns: Coupon Code, Reward Amount, State, City, UPI ID, Feedback, Timestamp, and Status. The table must have clear row styling, alternating or bordered rows, and be horizontally scrollable on mobile.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-update-usequeries-ts-to-add-a-usemarkasredeemed-mutation-hook-that-calls-the-backend-markasredeemed-function-with-a-coupon-code-and-invalidates-the-submissions-query-on-success-expose-this-hook-for-use-in-adminpanel-tsx",
      "title": "Update useQueries.ts to add a useMarkAsRedeemed mutation hook that calls the backend markAsRedeemed function with a coupon code and invalidates the submissions query on success. Expose this hook for use in AdminPanel.tsx.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-diagnose-and-fix-the-runtime-error-thrown-when-the-user-clicks-the-submit-button-on-the-claimform-inspect-the-usesubmitclaim-hook-in-usequeries-ts-and-the-claimform-component-to-identify-the-exact-failure-point-e-g-missing-or-undefined-actor-incorrect-argument-shape-passed-to-the-backend-submitclaim-function-type-mismatch-between-frontend-payload-and-motoko-actor-method-signature-ensure-the-mutation-is-called-with-all-required-fields-couponcode-rewardamount-state-city-feedback-upiid-with-correct-types-error-boundaries-are-in-place-and-the-error-is-surfaced-to-the-user-with-a-visible-inline-message-rather-than-a-silent-failure-or-crash",
      "title": "Diagnose and fix the runtime error thrown when the user clicks the 'Submit' button on the ClaimForm. Inspect the useSubmitClaim hook in useQueries.ts and the ClaimForm component to identify the exact failure point (e.g., missing or undefined actor, incorrect argument shape passed to the backend submitClaim function, type mismatch between frontend payload and Motoko actor method signature). Ensure the mutation is called with all required fields (couponCode, rewardAmount, state, city, feedback, upiId) with correct types, error boundaries are in place, and the error is surfaced to the user with a visible inline message rather than a silent failure or crash.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-diagnose-and-fix-the-end-to-end-data-flow-so-that-when-a-user-successfully-submits-the-claim-form-claimform-tsx-the-submission-is-persisted-to-the-motoko-backend-and-immediately-visible-in-the-admin-panel-adminpanel-tsx-trace-the-full-path-claimform-usesubmitclaim-mutation-in-usequeries-ts-backend-submitclaim-actor-method-getsubmissions-query-used-by-adminpanel-verify-that-1-the-usesubmitclaim-mutation-correctly-calls-the-backend-actor-s-submitclaim-function-with-all-required-fields-couponcode-rewardamount-state-city-feedback-upiid-2-on-mutation-success-the-react-query-cache-for-the-submissions-query-key-is-invalidated-so-adminpanel-fetches-fresh-data-3-the-usesubmissions-or-equivalent-hook-in-usequeries-ts-is-correctly-wired-in-adminpanel-tsx-and-is-not-using-a-stale-or-empty-cache-4-the-backend-submitclaim-function-stores-the-record-in-stable-persistent-state-and-getsubmissions-returns-it-fix-all-broken-links-in-this-chain",
      "title": "Diagnose and fix the end-to-end data flow so that when a user successfully submits the claim form (ClaimForm.tsx), the submission is persisted to the Motoko backend and immediately visible in the Admin Panel (AdminPanel.tsx). Trace the full path: ClaimForm → useSubmitClaim mutation in useQueries.ts → backend submitClaim actor method → getSubmissions query used by AdminPanel. Verify that: (1) the useSubmitClaim mutation correctly calls the backend actor's submitClaim function with all required fields (couponCode, rewardAmount, state, city, feedback, upiId); (2) on mutation success, the React Query cache for the submissions query key is invalidated so AdminPanel fetches fresh data; (3) the useSubmissions (or equivalent) hook in useQueries.ts is correctly wired in AdminPanel.tsx and is not using a stale or empty cache; (4) the backend submitClaim function stores the record in stable/persistent state and getSubmissions returns it. Fix all broken links in this chain.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-diagnose-and-fix-the-admin-panel-login-flow-in-adminloginmodal-tsx-and-app-tsx-ensure-that-1-double-clicking-the-vitalis-logo-in-the-header-correctly-opens-the-adminloginmodal-2-entering-email-shajan-vitalis-com-and-password-india-123-successfully-authenticates-and-navigates-to-the-adminpanel-3-incorrect-credentials-display-a-clear-inline-error-message-4-the-authenticated-admin-session-is-correctly-persisted-in-sessionstorage-so-the-adminpanel-remains-accessible-on-navigation-without-re-prompting-login-5-the-logout-action-clears-the-session-and-returns-the-user-to-scratchpage-fix-any-broken-event-wiring-state-mismatches-or-routing-logic-that-prevents-the-login-from-working",
      "title": "Diagnose and fix the admin panel login flow in AdminLoginModal.tsx and App.tsx. Ensure that: (1) double-clicking the Vitalis logo in the header correctly opens the AdminLoginModal; (2) entering email 'shajan@vitalis.com' and password 'India@123' successfully authenticates and navigates to the AdminPanel; (3) incorrect credentials display a clear inline error message; (4) the authenticated admin session is correctly persisted in sessionStorage so the AdminPanel remains accessible on navigation without re-prompting login; (5) the logout action clears the session and returns the user to ScratchPage. Fix any broken event wiring, state mismatches, or routing logic that prevents the login from working.",
      "reqIds": [
        "REQ-27"
      ],
      "version": 1
    },
    {
      "id": "feature-in-frontend-src-hooks-usequeries-ts-and-frontend-src-components-claimform-tsx-add-explicit-error-handling-for-ic0508-canister-stopped-rejections-when-the-mutation-receives-a-rejection-with-error-code-ic0508-or-reject-code-5-display-a-user-friendly-inline-error-message-such-as-service-temporarily-unavailable-please-try-again-in-a-moment-instead-of-a-silent-failure-or-raw-error-object",
      "title": "In frontend/src/hooks/useQueries.ts and frontend/src/components/ClaimForm.tsx, add explicit error handling for IC0508 canister-stopped rejections. When the mutation receives a rejection with error_code 'IC0508' or reject_code 5, display a user-friendly inline error message such as 'Service temporarily unavailable. Please try again in a moment.' instead of a silent failure or raw error object.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-end-to-end-persistence-and-retrieval-of-claim-submission-data-so-that-after-a-user-submits-the-claim-form-the-full-record-coupon-code-reward-amount-state-city-upi-id-feedback-timestamp-status-is-correctly-stored-in-the-motoko-backend-s-stable-state-and-returned-in-full-by-getsubmissions-audit-backend-main-mo-to-ensure-1-the-submitclaim-function-writes-all-fields-to-stable-storage-without-dropping-or-ignoring-any-field-2-the-getsubmissions-function-reads-from-the-same-stable-variable-and-returns-the-complete-list-3-the-submission-record-type-includes-all-fields-couponcode-rewardamount-state-city-upiid-feedback-timestamp-status-audit-usequeries-ts-to-ensure-the-usesubmitclaim-mutation-passes-all-required-fields-with-correct-types-matching-the-motoko-function-signature-and-on-success-invalidates-the-submissions-react-query-cache-key-so-adminpanel-tsx-re-fetches-fresh-data",
      "title": "Fix the end-to-end persistence and retrieval of claim submission data so that after a user submits the claim form, the full record (coupon code, reward amount, state, city, UPI ID, feedback, timestamp, status) is correctly stored in the Motoko backend's stable state and returned in full by getSubmissions. Audit backend/main.mo to ensure: (1) the submitClaim function writes all fields to stable storage without dropping or ignoring any field; (2) the getSubmissions function reads from the same stable variable and returns the complete list; (3) the Submission record type includes all fields: couponCode, rewardAmount, state, city, upiId, feedback, timestamp, status. Audit useQueries.ts to ensure the useSubmitClaim mutation passes all required fields with correct types matching the Motoko function signature, and on success invalidates the submissions React Query cache key so AdminPanel.tsx re-fetches fresh data.",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Random reward generator (₹10–₹100) on every page load",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Scratch card UI with animated scratch overlay and glassmorphism design",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Confetti celebration animation after reward reveal",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Unique code displayed on each scratch card",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Water drop animation on page load and bottle image hero section",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Page sections: logo, 'Scan. Scratch. Win.' tagline, scratch card, reward reveal, footer with brand name",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Sound effect on scratch interaction",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Fully mobile-optimized, fast-loading, embed-friendly for Google Sites",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Weighted reward probability: 90% ₹10, 4% ₹20, ~4% ₹30, 2% ₹90, 0.1% ₹100",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Claim button after scratch reveal that opens a form with state, city, feedback, and UPI ID fields",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "After form submission, show animated 'Money will be in your account soon' confirmation notification",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Admin panel to view all submitted coupon codes and claim details (state, city, UPI ID, reward amount)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Use uploaded brand logo in header and throughout the UI for a professional look",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "On claim form submission, save the entry to the Motoko backend actor. Each submission must store: the unique coupon code (VW-XXXX-XXXX), reward amount, state, city, feedback, UPI ID, and a timestamp. Expose a query method to retrieve all submissions (for the admin panel). Expose a query method to retrieve a single submission by coupon code.",
      "reqIds": [
        "REQ-12"
      ],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Admin panel login: triggered by double-clicking the Vitalis logo, then prompting for email (shajan@vitalis.com) and password (India@123) instead of a simple password prompt",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Remove the water bottle illustration from the page — show only the scratch card UI. After fully scratching, generate and display a new unique code and reward amount. The claim form must be hidden until scratch is complete, then revealed cleanly.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Fix the claim/submit button flow — clicking 'Claim' and 'Submit' must work correctly end-to-end, including form validation and showing the confirmation screen",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-22",
      "summary": "Make the Vitalis logo fully visible and prominent in the header — fix any cropping, sizing, or styling issues making it look ugly",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Redesign the admin panel UI to look professional and polished. Add coupon verification: admin can look up a coupon code, verify if it is valid, and mark it as redeemed/closed so it cannot be claimed again",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Update the Motoko backend (backend/main.mo) to add a 'status' field to the Submission record type (values: 'active' or 'redeemed'). Add an update function markAsRedeemed(couponCode: Text) : async Bool that sets the status of the matching submission to 'redeemed' and returns true if found, false otherwise. Ensure the existing submitClaim and getSubmissions functions include the status field. Default status for all new submissions is 'active'.",
      "reqIds": [
        "REQ-23"
      ],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "After submitting the claim form, the submitted data is not appearing in the admin panel — fix the data flow so claim submissions are saved and visible in the admin panel",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "In backend/main.mo, ensure the actor is structured to start in a running state and does not enter a stopped condition. Add defensive guards so that if the canister is restarted, all stable state (submissions, reward records) is preserved without data loss. Verify that the submitClaim, getSubmissions, and markAsRedeemed functions are all correctly exposed as public shared functions and compile without errors that could cause the canister to stop.",
      "reqIds": [
        "REQ-28"
      ],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "Fix the 'Unauthorized: Only admins can view submissions' error in the backend. In backend/main.mo, the getSubmissions (and any other admin-gated) function must not require Internet Identity authentication or any caller-identity check that blocks access when called from the frontend admin panel. Since the admin panel uses a hardcoded frontend credential check (email/password in sessionStorage), the backend getSubmissions, getStats, and markAsRedeemed functions must be accessible without rejecting the caller as unauthorized. Remove or disable any caller-identity-based admin guard in main.mo that currently causes this rejection, so any caller (including anonymous) can invoke these query/update functions.",
      "reqIds": [
        "REQ-30"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Vitalist Water Scratch & Win",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}